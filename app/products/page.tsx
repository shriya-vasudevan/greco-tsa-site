import Acc from "@/components/accordion";
import Prod from "@/components/product";

async function product () {
  const req = await fetch("https://www.homedepot.com/federation-gateway/graphql?opname=searchModel", {
  "headers": {
      "accept": "*/*",
      "accept-language": "en-US,en;q=0.9,ta;q=0.8",
      "content-type": "application/json",
      "sec-ch-ua": "\"Chromium\";v=\"122\", \"Not(A:Brand\";v=\"24\", \"Google Chrome\";v=\"122\"",
      "sec-ch-ua-mobile": "?1",
      "sec-ch-ua-platform": "\"Android\"",
      "sec-fetch-dest": "empty",
      "sec-fetch-mode": "cors",
      "sec-fetch-site": "same-origin",
      "x-api-cookies": "{\"x-user-id\":\"b42abc72-0da5-0d75-9755-8606a942c0d9\"}",
      "x-cloud-trace-context": "5b783823855f4d759e3fc609b9676865/1;o=1",
      "x-current-url": "/s/renewable%20energy%20windmills%20solar%20panels",
      "x-debug": "false",
      "x-experience-name": "general-merchandise",
      "x-hd-dc": "origin",
      "x-parent-trace-id": "e526926af3f1dc7a9047d89f1f7c93fd/13320166598606951408",
      "x-thd-customer-token": "",
      "cookie": "IN_STORE_API_SESSION=TRUE",
      "Referer": "https://www.homedepot.com/s/renewable%20energy%20windmills%20solar%20panels?NCNI-5",
      "Referrer-Policy": "strict-origin-when-cross-origin"
  },
  "body": "{\"operationName\":\"searchModel\",\"variables\":{\"skipInstallServices\":false,\"skipKPF\":false,\"skipSpecificationGroup\":false,\"skipSubscribeAndSave\":false,\"storefilter\":\"ALL\",\"channel\":\"MOBILE\",\"skipDiscoveryZones\":true,\"skipBuyitagain\":true,\"additionalSearchParams\":{\"sponsored\":true,\"mcvisId\":\"15263424357315964471526447847603738020\",\"deliveryZip\":\"27518\",\"multiStoreIds\":[]},\"filter\":{},\"keyword\":\"renewable%20energy%20windmills%20solar%20panels\",\"navParam\":null,\"orderBy\":{\"field\":\"BEST_MATCH\",\"order\":\"ASC\"},\"pageSize\":48,\"startIndex\":0,\"storeId\":\"3615\",\"zipCode\":\"27518\"},\"query\":\"query searchModel($storeId: String, $zipCode: String, $skipInstallServices: Boolean = true, $startIndex: Int, $pageSize: Int, $orderBy: ProductSort, $filter: ProductFilter, $skipKPF: Boolean = false, $skipSpecificationGroup: Boolean = false, $skipSubscribeAndSave: Boolean = false, $keyword: String, $navParam: String, $storefilter: StoreFilter = ALL, $itemIds: [String], $channel: Channel = DESKTOP, $additionalSearchParams: AdditionalParams, $loyaltyMembershipInput: LoyaltyMembershipInput, $dataSource: String, $skipDiscoveryZones: Boolean = true, $skipBuyitagain: Boolean = true) {\\n  searchModel(\\n    keyword: $keyword\\n    navParam: $navParam\\n    storefilter: $storefilter\\n    storeId: $storeId\\n    itemIds: $itemIds\\n    channel: $channel\\n    additionalSearchParams: $additionalSearchParams\\n    loyaltyMembershipInput: $loyaltyMembershipInput\\n  ) {\\n    metadata {\\n      hasPLPBanner\\n      categoryID\\n      analytics {\\n        semanticTokens\\n        dynamicLCA\\n        __typename\\n      }\\n      canonicalUrl\\n      searchRedirect\\n      clearAllRefinementsURL\\n      contentType\\n      h1Tag\\n      isStoreDisplay\\n      productCount {\\n        inStore\\n        __typename\\n      }\\n      stores {\\n        storeId\\n        storeName\\n        address {\\n          postalCode\\n          __typename\\n        }\\n        nearByStores {\\n          storeId\\n          storeName\\n          distance\\n          address {\\n            postalCode\\n            __typename\\n          }\\n          __typename\\n        }\\n        __typename\\n      }\\n      __typename\\n    }\\n    products(\\n      startIndex: $startIndex\\n      pageSize: $pageSize\\n      orderBy: $orderBy\\n      filter: $filter\\n    ) {\\n      identifiers {\\n        storeSkuNumber\\n        specialOrderSku\\n        canonicalUrl\\n        brandName\\n        itemId\\n        productLabel\\n        productType\\n        modelNumber\\n        parentId\\n        isSuperSku\\n        sampleId\\n        __typename\\n      }\\n      installServices(storeId: $storeId, zipCode: $zipCode) @skip(if: $skipInstallServices) {\\n        scheduleAMeasure\\n        gccCarpetDesignAndOrderEligible\\n        __typename\\n      }\\n      info {\\n        sponsoredMetadata {\\n          sponsoredId\\n          trackSource\\n          campaignId\\n          placementId\\n          slotId\\n          __typename\\n        }\\n        sponsoredBeacon {\\n          onClickBeacons\\n          onViewBeacons\\n          onClickBeacon\\n          onViewBeacon\\n          __typename\\n        }\\n        swatches {\\n          isSelected\\n          itemId\\n          label\\n          swatchImgUrl\\n          url\\n          value\\n          __typename\\n        }\\n        hidePrice\\n        ecoRebate\\n        quantityLimit\\n        categoryHierarchy\\n        sskMin\\n        sskMax\\n        unitOfMeasureCoverage\\n        wasMaxPriceRange\\n        wasMinPriceRange\\n        productSubType {\\n          name\\n          link\\n          __typename\\n        }\\n        customerSignal {\\n          previouslyPurchased\\n          __typename\\n        }\\n        isBuryProduct\\n        isGenericProduct\\n        returnable\\n        isLiveGoodsProduct\\n        isSponsored\\n        globalCustomConfigurator {\\n          customExperience\\n          __typename\\n        }\\n        augmentedReality\\n        hasSubscription\\n        samplesAvailable\\n        totalNumberOfOptions\\n        classNumber\\n        productDepartment\\n        __typename\\n      }\\n      itemId\\n      dataSources\\n      media {\\n        images {\\n          url\\n          type\\n          subType\\n          sizes\\n          __typename\\n        }\\n        __typename\\n      }\\n      pricing(storeId: $storeId) {\\n        value\\n        alternatePriceDisplay\\n        alternate {\\n          bulk {\\n            pricePerUnit\\n            thresholdQuantity\\n            value\\n            __typename\\n          }\\n          unit {\\n            caseUnitOfMeasure\\n            unitsOriginalPrice\\n            unitsPerCase\\n            value\\n            __typename\\n          }\\n          __typename\\n        }\\n        original\\n        mapAboveOriginalPrice\\n        message\\n        preferredPriceFlag\\n        promotion {\\n          type\\n          description {\\n            shortDesc\\n            longDesc\\n            __typename\\n          }\\n          dollarOff\\n          percentageOff\\n          promotionTag\\n          savingsCenter\\n          savingsCenterPromos\\n          specialBuySavings\\n          specialBuyDollarOff\\n          specialBuyPercentageOff\\n          dates {\\n            start\\n            end\\n            __typename\\n          }\\n          __typename\\n        }\\n        specialBuy\\n        unitOfMeasure\\n        __typename\\n      }\\n      reviews {\\n        ratingsReviews {\\n          averageRating\\n          totalReviews\\n          __typename\\n        }\\n        __typename\\n      }\\n      details {\\n        installation {\\n          serviceType\\n          __typename\\n        }\\n        collection {\\n          name\\n          url\\n          collectionId\\n          __typename\\n        }\\n        highlights\\n        __typename\\n      }\\n      fulfillment(storeId: $storeId, zipCode: $zipCode) {\\n        anchorStoreStatus\\n        anchorStoreStatusType\\n        backordered\\n        backorderedShipDate\\n        bossExcludedShipStates\\n        excludedShipStates\\n        seasonStatusEligible\\n        fulfillmentOptions {\\n          type\\n          fulfillable\\n          services {\\n            deliveryTimeline\\n            deliveryDates {\\n              startDate\\n              endDate\\n              __typename\\n            }\\n            deliveryCharge\\n            dynamicEta {\\n              hours\\n              minutes\\n              __typename\\n            }\\n            hasFreeShipping\\n            freeDeliveryThreshold\\n            locations {\\n              curbsidePickupFlag\\n              isBuyInStoreCheckNearBy\\n              distance\\n              inventory {\\n                isOutOfStock\\n                isInStock\\n                isLimitedQuantity\\n                isUnavailable\\n                quantity\\n                maxAllowedBopisQty\\n                minAllowedBopisQty\\n                __typename\\n              }\\n              isAnchor\\n              locationId\\n              state\\n              storeName\\n              storePhone\\n              type\\n              __typename\\n            }\\n            type\\n            totalCharge\\n            __typename\\n          }\\n          __typename\\n        }\\n        onlineStoreStatus\\n        onlineStoreStatusType\\n        __typename\\n      }\\n      availabilityType {\\n        type\\n        discontinued\\n        buyable\\n        status\\n        __typename\\n      }\\n      badges(storeId: $storeId) {\\n        name\\n        label\\n        __typename\\n      }\\n      dataSource\\n      favoriteDetail {\\n        count\\n        __typename\\n      }\\n      keyProductFeatures @skip(if: $skipKPF) {\\n        keyProductFeaturesItems {\\n          features {\\n            name\\n            refinementId\\n            refinementUrl\\n            value\\n            __typename\\n          }\\n          __typename\\n        }\\n        __typename\\n      }\\n      specificationGroup @skip(if: $skipSpecificationGroup) {\\n        specifications {\\n          specName\\n          specValue\\n          __typename\\n        }\\n        specTitle\\n        __typename\\n      }\\n      subscription @skip(if: $skipSubscribeAndSave) {\\n        defaultfrequency\\n        discountPercentage\\n        subscriptionEnabled\\n        __typename\\n      }\\n      __typename\\n    }\\n    id\\n    searchReport {\\n      totalProducts\\n      didYouMean\\n      correctedKeyword\\n      keyword\\n      pageSize\\n      searchUrl\\n      sortBy\\n      sortOrder\\n      startIndex\\n      __typename\\n    }\\n    relatedResults {\\n      universalSearch {\\n        title\\n        __typename\\n      }\\n      relatedServices {\\n        label\\n        __typename\\n      }\\n      visualNavs {\\n        label\\n        imageId\\n        webUrl\\n        categoryId\\n        imageURL\\n        __typename\\n      }\\n      visualNavContainsEvents\\n      relatedKeywords {\\n        keyword\\n        __typename\\n      }\\n      __typename\\n    }\\n    taxonomy {\\n      brandLinkUrl\\n      breadCrumbs {\\n        browseUrl\\n        creativeIconUrl\\n        deselectUrl\\n        dimensionId\\n        dimensionName\\n        label\\n        refinementKey\\n        url\\n        __typename\\n      }\\n      __typename\\n    }\\n    templates\\n    partialTemplates\\n    dimensions {\\n      label\\n      refinements {\\n        refinementKey\\n        label\\n        recordCount\\n        selected\\n        imgUrl\\n        url\\n        nestedRefinements {\\n          label\\n          url\\n          recordCount\\n          refinementKey\\n          __typename\\n        }\\n        __typename\\n      }\\n      collapse\\n      dimensionId\\n      isVisualNav\\n      isVisualDimension\\n      isNumericFilter\\n      isColorSwatch\\n      nestedRefinementsLimit\\n      visualNavSequence\\n      __typename\\n    }\\n    orangeGraph {\\n      universalSearchArray {\\n        pods {\\n          title\\n          description\\n          imageUrl\\n          link\\n          isProContent\\n          recordType\\n          __typename\\n        }\\n        info {\\n          title\\n          __typename\\n        }\\n        __typename\\n      }\\n      productTypes\\n      intents\\n      orderNumber\\n      __typename\\n    }\\n    discoveryZones @skip(if: $skipDiscoveryZones) {\\n      products(dataSource: $dataSource) {\\n        itemId\\n        dataSources\\n        badges(storeId: $storeId) {\\n          name\\n          __typename\\n        }\\n        info {\\n          isSponsored\\n          sponsoredMetadata {\\n            campaignId\\n            placementId\\n            slotId\\n            sponsoredId\\n            trackSource\\n            __typename\\n          }\\n          sponsoredBeacon {\\n            onClickBeacon\\n            onViewBeacon\\n            onClickBeacons\\n            onViewBeacons\\n            __typename\\n          }\\n          productSubType {\\n            name\\n            __typename\\n          }\\n          augmentedReality\\n          globalCustomConfigurator {\\n            customExperience\\n            __typename\\n          }\\n          swatches {\\n            isSelected\\n            itemId\\n            label\\n            swatchImgUrl\\n            url\\n            value\\n            __typename\\n          }\\n          totalNumberOfOptions\\n          hidePrice\\n          ecoRebate\\n          quantityLimit\\n          categoryHierarchy\\n          sskMin\\n          sskMax\\n          unitOfMeasureCoverage\\n          wasMaxPriceRange\\n          wasMinPriceRange\\n          __typename\\n        }\\n        identifiers {\\n          canonicalUrl\\n          productType\\n          productLabel\\n          modelNumber\\n          storeSkuNumber\\n          itemId\\n          brandName\\n          parentId\\n          __typename\\n        }\\n        media {\\n          images {\\n            url\\n            type\\n            subType\\n            sizes\\n            __typename\\n          }\\n          __typename\\n        }\\n        dataSource\\n        details {\\n          collection {\\n            name\\n            url\\n            __typename\\n          }\\n          __typename\\n        }\\n        pricing(storeId: $storeId) {\\n          alternatePriceDisplay\\n          alternate {\\n            bulk {\\n              pricePerUnit\\n              thresholdQuantity\\n              value\\n              __typename\\n            }\\n            unit {\\n              caseUnitOfMeasure\\n              unitsOriginalPrice\\n              unitsPerCase\\n              value\\n              __typename\\n            }\\n            __typename\\n          }\\n          original\\n          mapAboveOriginalPrice\\n          message\\n          preferredPriceFlag\\n          promotion {\\n            type\\n            description {\\n              shortDesc\\n              longDesc\\n              __typename\\n            }\\n            dollarOff\\n            percentageOff\\n            promotionTag\\n            savingsCenter\\n            savingsCenterPromos\\n            specialBuySavings\\n            specialBuyDollarOff\\n            specialBuyPercentageOff\\n            __typename\\n          }\\n          specialBuy\\n          unitOfMeasure\\n          value\\n          __typename\\n        }\\n        __typename\\n      }\\n      metadata {\\n        zone\\n        zoneTitle\\n        __typename\\n      }\\n      __typename\\n    }\\n    appliedDimensions {\\n      label\\n      refinements {\\n        label\\n        refinementKey\\n        url\\n        __typename\\n      }\\n      isNumericFilter\\n      __typename\\n    }\\n    primaryFilters {\\n      collapse\\n      dimensionId\\n      isVisualNav\\n      isVisualDimension\\n      isNumericFilter\\n      isColorSwatch\\n      label\\n      nestedRefinementsLimit\\n      refinements {\\n        label\\n        refinementKey\\n        recordCount\\n        selected\\n        imgUrl\\n        url\\n        nestedRefinements {\\n          label\\n          url\\n          recordCount\\n          refinementKey\\n          __typename\\n        }\\n        __typename\\n      }\\n      visualNavSequence\\n      __typename\\n    }\\n    buyitagain(dataSource: $dataSource) @skip(if: $skipBuyitagain) {\\n      itemId\\n      dataSources\\n      badges(storeId: $storeId) {\\n        name\\n        __typename\\n      }\\n      info {\\n        isSponsored\\n        sponsoredMetadata {\\n          campaignId\\n          placementId\\n          slotId\\n          sponsoredId\\n          trackSource\\n          __typename\\n        }\\n        sponsoredBeacon {\\n          onClickBeacon\\n          onViewBeacon\\n          onClickBeacons\\n          onViewBeacons\\n          __typename\\n        }\\n        productSubType {\\n          name\\n          link\\n          __typename\\n        }\\n        augmentedReality\\n        globalCustomConfigurator {\\n          customExperience\\n          __typename\\n        }\\n        customerSignal {\\n          previouslyPurchased\\n          __typename\\n        }\\n        isBuryProduct\\n        isGenericProduct\\n        returnable\\n        hidePrice\\n        ecoRebate\\n        quantityLimit\\n        categoryHierarchy\\n        sskMin\\n        sskMax\\n        unitOfMeasureCoverage\\n        wasMaxPriceRange\\n        wasMinPriceRange\\n        __typename\\n      }\\n      identifiers {\\n        canonicalUrl\\n        productType\\n        productLabel\\n        modelNumber\\n        storeSkuNumber\\n        itemId\\n        brandName\\n        specialOrderSku\\n        __typename\\n      }\\n      media {\\n        images {\\n          url\\n          type\\n          subType\\n          sizes\\n          __typename\\n        }\\n        __typename\\n      }\\n      details {\\n        installation {\\n          serviceType\\n          __typename\\n        }\\n        collection {\\n          name\\n          url\\n          __typename\\n        }\\n        __typename\\n      }\\n      fulfillment(storeId: $storeId, zipCode: $zipCode) {\\n        anchorStoreStatus\\n        anchorStoreStatusType\\n        backordered\\n        backorderedShipDate\\n        bossExcludedShipStates\\n        excludedShipStates\\n        seasonStatusEligible\\n        fulfillmentOptions {\\n          type\\n          fulfillable\\n          services {\\n            deliveryTimeline\\n            deliveryDates {\\n              startDate\\n              endDate\\n              __typename\\n            }\\n            deliveryCharge\\n            dynamicEta {\\n              hours\\n              minutes\\n              __typename\\n            }\\n            hasFreeShipping\\n            freeDeliveryThreshold\\n            locations {\\n              curbsidePickupFlag\\n              isBuyInStoreCheckNearBy\\n              distance\\n              inventory {\\n                isOutOfStock\\n                isInStock\\n                isLimitedQuantity\\n                isUnavailable\\n                quantity\\n                maxAllowedBopisQty\\n                minAllowedBopisQty\\n                __typename\\n              }\\n              isAnchor\\n              locationId\\n              state\\n              storeName\\n              storePhone\\n              type\\n              __typename\\n            }\\n            type\\n            totalCharge\\n            __typename\\n          }\\n          __typename\\n        }\\n        onlineStoreStatus\\n        onlineStoreStatusType\\n        __typename\\n      }\\n      installServices(storeId: $storeId, zipCode: $zipCode) @skip(if: $skipInstallServices) {\\n        scheduleAMeasure\\n        gccCarpetDesignAndOrderEligible\\n        __typename\\n      }\\n      pricing(storeId: $storeId) {\\n        alternatePriceDisplay\\n        alternate {\\n          bulk {\\n            pricePerUnit\\n            thresholdQuantity\\n            value\\n            __typename\\n          }\\n          unit {\\n            caseUnitOfMeasure\\n            unitsOriginalPrice\\n            unitsPerCase\\n            value\\n            __typename\\n          }\\n          __typename\\n        }\\n        original\\n        mapAboveOriginalPrice\\n        message\\n        preferredPriceFlag\\n        promotion {\\n          type\\n          description {\\n            shortDesc\\n            longDesc\\n            __typename\\n          }\\n          dollarOff\\n          percentageOff\\n          promotionTag\\n          savingsCenter\\n          savingsCenterPromos\\n          specialBuySavings\\n          specialBuyDollarOff\\n          specialBuyPercentageOff\\n          __typename\\n        }\\n        specialBuy\\n        unitOfMeasure\\n        value\\n        __typename\\n      }\\n      dataSource\\n      __typename\\n    }\\n    __typename\\n  }\\n}\"}",
  "method": "POST"
  });
  const resp = await req.json();
  return resp;
};

export default async function Products () {
  const data = await product();

  return (
      <>
        <Acc/>
        <div className="mt-8 relative grid grid-flow-row auto-rows-max gap-32 lg:gap-12 lg:grid-cols-4 items-end justify-center overflow-hidden p-8">
              {data.data.searchModel.products ? (
                  data.data.searchModel.products.map((i: { identifiers: { productLabel: string, canonicalUrl: string }, pricing: { value: number }, media: { images: [ { url: string } ] }, reviews: { ratingsReviews: { averageRating: number }} }) => {
                    return (
                      <Prod key={i.identifiers.productLabel} link={`https://homedepot.com${i.identifiers.canonicalUrl}`} image={i.media.images[0].url.replaceAll(/<SIZE>/g, "400")} product={i.identifiers.productLabel} price={"$" + i?.pricing?.value} value={Math.round(i.reviews.ratingsReviews.averageRating)} />
                    );
                  })) : (
                  <p>Loading...</p>
              )}
          </div>
      </>
  );
};
